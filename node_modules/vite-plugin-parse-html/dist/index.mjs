import{render as l}from"ejs";import{createFilter as a}from"@rollup/pluginutils";var p=a(["**/*.html"]),s=t=>{if(t.indexOf(".css")!==-1)return"css";if(t.indexOf(".js")!==-1)return"javascript"};function u(t){let e=[];return t.length&&t.forEach(r=>typeof r=="string"?e.push({tag:s(r)==="css"?"link":"script",attrs:{[s(r)==="css"?"herf":"src"]:r},injectTo:"head"}):e.push({tag:r.type==="javascript"?"script":"link",attrs:{[r.type==="javascript"?"src":"herf"]:r.url,...r.attrs},injectTo:r.position||"head"})),e}function m(t){let{data:e,ejsOptions:r,sources:n=[]}=t;return{name:"vite-parse-html",enforce:"pre",transformIndexHtml:{enforce:"pre",async transform(f){return{html:await l(f,e,r),tags:u(n)}}}}}import{minify as g}from"html-minifier-terser";function y(t){return{collapseWhitespace:t,keepClosingSlash:t,removeComments:t,minifyCSS:t}}function c({isMinify:t=!0}){return{name:"vite: minify-html",enforce:"post",async generateBundle(e,r){if(t)for(let n of Object.values(r))n.type==="asset"&&p(n.fileName)&&typeof n.source=="string"&&(n.source=await g(n.source,y(t)))}}}var T=t=>{let{inject:e={},minifyOpt:r={}}=t;return[m(e),c(r)]};export{T as default,m as inject,c as minify};
